<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>SLC-ALEX Property Analyzer</title>
        <link rel="stylesheet" href="styles.css" />
        </head>

        <body>
          <div class="overlay"></div>

            <main>
                <!-- Hero Section -->
                    <section class="hero">
                          <h1>üè† SLC-ALEX Property Analyzer</h1>
                                <p id="backend-status">üî¥ Backend Connection Failed</p>
                                    </section>

                                        <!-- Form Section -->
                                            <section class="form-section">
                                                  <form id="property-form">
                                                          <label for="address">Property Address:</label>
                                                                  <input
                                                                            type="text"
                                                                                      id="address"
                                                                                                placeholder="6 Kempton Street, Fall River, MA"
                                                                                                          required
                                                                                                                  />

                                                                                                                          <label for="rate">Interest Rate (%):</label>
                                                                                                                                  <input
                                                                                                                                            type="number"
                                                                                                                                                      id="rate"
                                                                                                                                                                step="0.1"
                                                                                                                                                                          placeholder="6.5"
                                                                                                                                                                                    required
                                                                                                                                                                                            />

                                                                                                                                                                                                    <button type="submit">üîç Analyze Property</button>
                                                                                                                                                                                                          </form>

                                                                                                                                                                                                                <div id="results"></div>
                                                                                                                                                                                                                    </section>
                                                                                                                                                                                                                      </main>

                                                                                                                                                                                                                        <footer>
                                                                                                                                                                                                                            <p>‚öôÔ∏è Powered by ALEX Backend</p>
                                                                                                                                                                                                                              </footer>

                                                                                                                                                                                                                                <script>
                                                                                                                                                                                                                                    const backendUrl =
                                                                                                                                                                                                                                          "https://laughing-train-v6j97jw7vqgj2w575-4000.app.github.dev";

                                                                                                                                                                                                                                              // ‚úÖ Check backend connection
                                                                                                                                                                                                                                                  async function checkBackend() {
                                                                                                                                                                                                                                                        const statusEl = document.getElementById("backend-status");
                                                                                                                                                                                                                                                              try {
                                                                                                                                                                                                                                                                      const res = await fetch(backendUrl + "/");
                                                                                                                                                                                                                                                                              const data = await res.json();
                                                                                                                                                                                                                                                                                      if (data.status === "ok") {
                                                                                                                                                                                                                                                                                                statusEl.textContent = "üü¢ Backend Connected";
                                                                                                                                                                                                                                                                                                          statusEl.style.color = "#00ff66";
                                                                                                                                                                                                                                                                                                                  } else {
                                                                                                                                                                                                                                                                                                                            statusEl.textContent = "üî¥ Backend Connection Failed";
                                                                                                                                                                                                                                                                                                                                      statusEl.style.color = "red";
                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                    } catch {
                                                                                                                                                                                                                                                                                                                                                            statusEl.textContent = "üî¥ Backend Connection Failed";
                                                                                                                                                                                                                                                                                                                                                                    statusEl.style.color = "red";
                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                              }

                                                                                                                                                                                                                                                                                                                                                                                  checkBackend();

                                                                                                                                                                                                                                                                                                                                                                                      // ‚úÖ Form submit handler
                                                                                                                                                                                                                                                                                                                                                                                          document
                                                                                                                                                                                                                                                                                                                                                                                                .getElementById("property-form")
                                                                                                                                                                                                                                                                                                                                                                                                      .addEventListener("submit", async (e) => {
                                                                                                                                                                                                                                                                                                                                                                                                              e.preventDefault();
                                                                                                                                                                                                                                                                                                                                                                                                                      const address = document.getElementById("address").value;
                                                                                                                                                                                                                                                                                                                                                                                                                              const interestRate = parseFloat(document.getElementById("rate").value);
                                                                                                                                                                                                                                                                                                                                                                                                                                      const resultsDiv = document.getElementById("results");
                                                                                                                                                                                                                                                                                                                                                                                                                                              resultsDiv.innerHTML = "<p>‚è≥ Fetching full property analysis...</p>";

                                                                                                                                                                                                                                                                                                                                                                                                                                                      try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                const res = await fetch(backendUrl + "/api/stress", {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            method: "POST",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        headers: { "Content-Type": "application/json" },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    body: JSON.stringify({ address, interestRate }),
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (!res.ok) throw new Error("Server error");

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  const data = await res.json();

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Build results automatically from all backend keys
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      let html = "<h3>üìä Analysis Results</h3><div class='result-box'>";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                for (const key in data) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            html += `<p><strong>${key.replace(/([A-Z])/g, " $1")}:</strong> ${
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          typeof data[key] === "number"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ? "$" + data[key].toLocaleString()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          : data[key]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }</p>`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          html += "</div>";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    resultsDiv.innerHTML = html;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } catch (err) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      console.error(err);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                resultsDiv.innerHTML =
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            "<p>‚ö†Ô∏è Could not fetch analysis. Check backend or input.</p>";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </html>