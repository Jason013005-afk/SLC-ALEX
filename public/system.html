<!DOCTYPE html>
<html>
<head>
  <title>ALEX™ Deal Analyzer</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="card">
    <h1>ALEX™ Deal Analyzer</h1>

    <input id="address" placeholder="Property Address (ex: 6 Kempton St Fall River MA)" />
    <input id="rate" placeholder="Interest Rate (%)" />

    <button onclick="analyze()">Analyze Deal</button>

    <div id="results"></div>
  </div>

<script>
async function analyze() {
  const address = document.getElementById("address").value;
  const interestRate = Number(document.getElementById("rate").value);

  const res = await fetch("/api/deal-grade", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ address, interestRate })
  });

  const data = await res.json();

  if (data.error) {
    document.getElementById("results").innerHTML =
      `<p style="color:red;">Error: ${data.error}</p>`;
    return;
  }

  document.getElementById("results").innerHTML = `
    <hr/>
    <p><strong>Address:</strong> ${data.address}</p>
    <p><strong>ZIP:</strong> ${data.zip}</p>
    <p><strong>Bedrooms:</strong> ${data.bedrooms}</p>
    <p><strong>HUD Rent:</strong> $${data.hudRent}</p>
    <p><strong>ARV:</strong> $${data.arv}</p>

    <hr/>

    <p><strong>Annual Rent:</strong> $${data.dealMetrics.annualRent}</p>
    <p><strong>Annual Expenses:</strong> $${data.dealMetrics.annualExpenses}</p>
    <p><strong>NOI:</strong> $${data.dealMetrics.annualNOI}</p>
    <p><strong>Mortgage:</strong> $${data.dealMetrics.mortgage}</p>
    <p><strong>Annual Cash Flow:</strong> $${data.dealMetrics.annualCashFlow}</p>
    <p><strong>Cap Rate:</strong> ${data.dealMetrics.capRatePct}%</p>
    <p><strong>DSCR:</strong> ${data.dealMetrics.dscr}</p>

    <h2>Deal Grade: ${data.dealScore}</h2>
  `;
}
</script>

</body>
</html>